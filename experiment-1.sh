MODEL_DIR="project/stable-diffusion/output/800"
SUBJECT="OscarSKS"

# arcfaces on the dataset used to train the stable diffusion model
mkdir experiments/arcfaces-training-set
docker compose run --rm arcfaces bash -c "python /arcfaces/arcfaces.py \
  --people \"[['oscar', ['/project/training/IMG_20230821_141251.jpg']], ['oscar', ['/project/training/IMG_20230821_141315.jpg']], ['oscar', ['/project/training/IMG_20230821_141259.jpg']], ['oscar', ['/project/training/IMG_20230821_141306.jpg']], ['oscar', ['/project/training/IMG_20230821_141344.jpg']]]\" \
  --images_dir /project/training \
  --out_dir /experiments/arcfaces-training-set"


# arcfaces on general stable diffusion 1.5 results
mkdir experiments/arcfaces-sd-subject
docker compose run --rm arcfaces bash -c "python /arcfaces/arcfaces.py \
  --people \"[['oscar', ['/project/training/IMG_20230821_141251.jpg']], ['oscar', ['/project/training/IMG_20230821_141315.jpg']], ['oscar', ['/project/training/IMG_20230821_141259.jpg']], ['oscar', ['/project/training/IMG_20230821_141306.jpg']], ['oscar', ['/project/training/IMG_20230821_141344.jpg']]]\" \
  --images_dir /experiments/sd-subject \
  --out_dir /experiments/arcfaces-sd-subject"

# echo -e "\n\n\nElegir manualmente 4 de las 10 generadas por cada referencia (24 en total). Escribir enter al acabar"
# read


# arcfaces on handpicked diffusion images
mkdir experiments/arcfaces-sd-subject-handpicked
docker compose run --rm arcfaces bash -c "python /arcfaces/arcfaces.py \
  --people \"[['oscar', ['/project/training/IMG_20230821_141251.jpg']], ['oscar', ['/project/training/IMG_20230821_141315.jpg']], ['oscar', ['/project/training/IMG_20230821_141259.jpg']], ['oscar', ['/project/training/IMG_20230821_141306.jpg']], ['oscar', ['/project/training/IMG_20230821_141344.jpg']]]\" \
  --images_dir /experiments/sd-subject-handpicked \
  --out_dir /experiments/arcfaces-sd-subject-handpicked"


# arcfaces on a dataset of 12 real images without the subject, 12 with him, and 24 with the subject generated by stable diffusion 1.5
mkdir experiments/arcfaces-experiment-1
docker compose run --rm arcfaces bash -c "python /arcfaces/arcfaces.py \
  --people \"[['oscar', ['/project/training/IMG_20230821_141251.jpg']], ['oscar', ['/project/training/IMG_20230821_141315.jpg']], ['oscar', ['/project/training/IMG_20230821_141259.jpg']], ['oscar', ['/project/training/IMG_20230821_141306.jpg']], ['oscar', ['/project/training/IMG_20230821_141344.jpg']]]\" \
  --images_dir /experiments/experiment-1 \
  --out_dir /experiments/arcfaces-experiment-1"

docker compose run --rm eval bash -c "python /experiments-code/evaluate-arcfaces.py \
  --csv /experiments/arcfaces-experiment-1/detailed_arcfaces.csv"